"""
题目：给你一个数组 arr ，该数组表示一个从 1 到 n 的数字排列。有一个长度为 n 的二进制字符串，该字符串上的所有位最初都设置为 0 。

在从 1 到 n 的每个步骤 i 中（假设二进制字符串和 arr 都是从 1 开始索引的情况下），二进制字符串上位于位置 arr[i] 的位将会设为 1 。

给你一个整数 m ，请你找出二进制字符串上存在长度为 m 的一组 1 的最后步骤。一组 1 是一个连续的、由 1 组成的子串，且左右两边不再有可以延伸的 1 。

返回存在长度 恰好 为 m 的 一组 1  的最后步骤。如果不存在这样的步骤，请返回 -1 。


示例 1：
输入：arr = [3,5,1,2,4], m = 1
输出：4
解释：
步骤 1："00100"，由 1 构成的组：["1"]
步骤 2："00101"，由 1 构成的组：["1", "1"]
步骤 3："10101"，由 1 构成的组：["1", "1", "1"]
步骤 4："11101"，由 1 构成的组：["111", "1"]
步骤 5："11111"，由 1 构成的组：["11111"]
存在长度为 1 的一组 1 的最后步骤是步骤 4 。

示例 2：
输入：arr = [3,1,5,4,2], m = 2
输出：-1
解释：
步骤 1："00100"，由 1 构成的组：["1"]
步骤 2："10100"，由 1 构成的组：["1", "1"]
步骤 3："10101"，由 1 构成的组：["1", "1", "1"]
步骤 4："10111"，由 1 构成的组：["1", "111"]
步骤 5："11111"，由 1 构成的组：["11111"]
不管是哪一步骤都无法形成长度为 2 的一组 1 。

示例 3：
输入：arr = [1], m = 1
输出：1

示例 4：
输入：arr = [2,1], m = 2
输出：2
 
提示：
n == arr.length
1 <= n <= 10^5
1 <= arr[i] <= n
arr 中的所有整数 互不相同
1 <= m <= arr.length
"""

import time
from typing import List
import bisect


class Solution1:
    def findLatestStep(self, arr: List[int], m: int) -> int:
        def hasSizeM(item):
            # 将item加入到临时数组中，并判断此时 1 的长度中是否长度为 m 的情况
            bisect.insort_left(sortList, item)
            lenSortList = len(sortList)
            start, curIdx = 0, 1
            while curIdx < lenSortList:
                if sortList[curIdx] - sortList[curIdx - 1] > 1:
                    if sortList[curIdx - 1] - sortList[start] + 1 == m:
                        return True
                    else:
                        start = curIdx
                curIdx += 1
            return sortList[curIdx - 1] - sortList[start] + 1 == m

        step = 0
        sortList = []
        for idx, item in enumerate(arr):
            if hasSizeM(item):
                step = idx + 1
        return step if step else -1


class Solution2:
    """
    采用逆向思维，对一个全为1的字符串，将位置为 arr[i] 的1修改为0，反向来求解（i从 n-1 -> 0），如果有长度为m的全1字符串，那么说明此时的i是最优解
    初始情况下 sortList = [0, lenArr + 1]
    然后插入的数据为 arr[i]
    通过获取插入的两边数据，判断两边的数据是否有切分为长度为m的全1子字符串，就说明此时是最优解
    """
    def findLatestStep(self, arr: List[int], m: int) -> int:
        
        lenArr = len(arr)
        sortList = [0, lenArr + 1]
        if lenArr == m: return lenArr

        for i in range(lenArr - 1, -1, -1):
            idx = bisect.bisect_left(sortList, arr[i])
            if arr[i] - sortList[idx - 1] - 1 == m or \
                sortList[idx] - arr[i] - 1 == m:
                return i
            sortList.insert(idx, arr[i])
        return -1


class Solution3:
    """
    每次对第 arr[k] 位操作时，只考虑与 arr[k] 相邻的两个串的长度就行

    b[i] 表示第 i 个位置作为边界bound时，全为1的字串的长度，b[i]可能是左边界，也可能是右边界，这取决于 arr[k] 与 i 的关系
    如果有解，我们要找到最后一个长度为m的串1被合并的操作，b[i] == m 因为最后所有的位置都会变为1，所以如果有串长度为m,它最后一定会被合并
    因为只对边界操作，所以不用更新区间内的数字，所以能达到O(n)的效果
    """
    def findLatestStep(self, arr: List[int], m: int) -> int:
        lenArr = len(arr)
        if lenArr == m: return lenArr
        if lenArr < m: return -1

        b = [0] * (lenArr + 2)  # 这里 b[0] 和 b[lenArr + 1] 没有任何的意义，主要是为了让后面的 b[idx - 1] 和 b[idx + 1] 在运算中兼容，因为 1 <= idx <= lenArr
        ret = -1
        for i in range(lenArr):
            idx = arr[i]
            # 左右两边都没有1的情况，那么有新的连续1的字串(一个1) b[idx]
            if b[idx - 1] == 0 and b[idx + 1] == 0:
                b[idx] = 1
            # 左边有为1的情况，那么拓宽左边的1，要将左边连续子串的首尾边界的值进行修改
            elif b[idx + 1] == 0:
                if b[idx - 1] == m: ret = i
                b[idx] = b[idx - 1] + 1  # 更新尾部
                b[idx - b[idx - 1]] = b[idx]  # 更新头部
            # 右边有为1的情况，那么拓宽右边的1，要将右边连续子串的首尾边界的值进行修改
            elif b[idx - 1] == 0:
                if b[idx + 1] == m: ret = i
                b[idx] = b[idx + 1] + 1
                b[idx + b[idx + 1]] = b[idx]
            # 左右两边都有为1的情况，那么需要连接左右两边的所有1，并且还需要修改最左侧头部和最右侧尾部的值
            else:
                if b[idx - 1] == m or b[idx + 1] == m: ret = i
                b[idx] = b[idx - 1] + b[idx + 1] + 1
                b[idx - b[idx - 1]] = b[idx]
                b[idx + b[idx + 1]] = b[idx]
            print(f'{b}')

        return ret



if __name__ == "__main__":
    test = [
        # [[3,5,1,2,4], 1],  # 4
        # [[3,1,5,4,2], 2],  # -1
        # [[1], 1],  # 1
        # [[2,1], 2],  # 2
        [[1,2], 1],  # 1
        # [[827,635,2938,5061,2479,2560,4423,1985,1656,1427,4209,1554,3638,367,2239,2656,3901,1938,3560,610,3727,1936,2501,1949,5528,3449,310,4156,2429,5295,5505,1848,2026,3984,534,3244,874,2522,5380,3994,4444,2538,3467,2466,1203,1351,3223,2416,4607,5649,5221,2476,4534,5110,2270,379,5698,4252,679,2499,1534,1,113,5821,896,3491,1236,3285,4023,2641,4274,1136,1899,1930,4770,4815,2923,1704,3687,474,373,5584,2624,1682,2845,1881,5345,88,972,2981,4677,1893,2961,2503,1561,2418,3831,1048,5472,3852,5087,159,2589,215,2091,869,3869,1270,2682,1632,5603,242,1625,3981,5573,2883,1711,5362,2941,917,5448,2052,560,2136,587,2787,624,3966,1329,5390,2049,5366,553,422,3274,659,700,1074,4456,2308,2029,3224,2603,665,5566,992,427,4052,1003,555,3739,4073,2875,4851,3433,21,3441,2380,3442,769,1191,3106,3509,5816,3821,5213,2649,1637,2111,2085,4287,5197,839,4785,1574,105,2202,5428,5047,901,4248,5032,1522,2419,2497,2207,298,779,5385,5177,2898,3862,5688,980,5025,1405,601,3890,2118,5687,3775,169,3986,2506,434,5655,863,2905,4395,2790,3086,1118,5591,2755,2119,4812,2377,1753,4557,3523,5758,3026,5204,3592,786,5000,5403,3887,2234,3681,2870,500,3194,4934,4869,4393,5352,3682,438,608,5524,3142,5468,3685,1128,2488,3464,3312,4731,3865,1359,1907,4185,4214,3087,2131,3120,475,1460,4884,1565,561,2229,441,851,4833,1983,2719,5257,3266,5070,2521,988,2763,4836,3178,4377,1927,4410,759,1805,2712,3778,2595,290,2618,2902,1090,217,847,1957,1297,5059,2069,1481,3634,369,1589,1031,3415,1839,535,2593,2022,3055,277,1558,4914,5684,2423,477,3505,16,484,2858,1570,919,4063,5316,1672,3736,1284,2768,5163,5727,3052,2796,875,2369,5288,2931,820,604,1017,3407,2470,4260,5806,4060,2766,415,1408,1158,890,1042,749,3956,4306,1504,3072,653,4212,3160,354,3993,4412,1377,4106,163,889,1510,315,395,2999,813,4338,4902,1597,5232,1679,2413,4129,1952,3275,1410,2671,2183,2839,2897,3594,2539,1227,737,1201,3002,4644,1071,5089,2842,5259,1414,3530,1688,5101,2309,1977,3379,5361,3894,5580,5346,3803,551,590,97,842,82,4589,3313,1746,1994,2859,3431,5829,4623,2744,3868,316,5424,2388,949,1501,3747,1779,3836,792,3680,178,5748,5184,656,3953,2472,3047,1751,1742,5430,5410,648,3860,1392,1352,5066,5438,5476,5595,1652,4933,4290,3284,3598,3582,2970,5050,4777,3591,4841,4178,5273,4146,5617,3102,3588,784,1114,5742,726,2566,1186,4468,1973,4521,954,5536,2355,1904,348,2932,1956,321,2040,4974,3874,1264,902,4332,1250,3065,4978,2432,5234,1549,933,2339,1966,49,1368,3537,830,3608,2412,1488,1775,596,1164,2042,5320,3076,2872,3819,603,4323,4269,64,4411,5473,1341,5008,5712,3675,72,1271,806,2066,834,1209,5670,782,3262,4876,3673,3566,5086,4431,4189,3085,153,4568,1587,3671,2912,1121,5269,3180,4029,5292,2427,4065,2721,621,3185,1972,854,4197,1398,3333,5825,4748,3399,2102,4489,4127,3226,2455,979,5012,4074,3531,2262,4773,2002,1663,398,219,1089,2717,2753,4863,5771,3235,2749,3772,2985,444,4881,2528,2203,3853,4264,2447,5713,3186,1247,777,5692,2409,3580,5645,79,5679,2442,4524,4713,5237,5466,2724,4180,1337,538,4311,2399,5211,326,3426,5328,3126,5487,5162,888,1374,4894,2564,1464,1279,4755,245,143,4350,1535,1960,1935,42,1507,4904,5551,2995,1767,2253,645,186,2363,3556,203,572,2686,1825,4984,1285,1934,140,811,3301,4479,3330,4463,795,1774,1063,3613,2010,4237,5165,5667,3805,464,3931,5589,1520,2943,5284,1693,2025,3167,3790,1309,5005,3310,4181,3761,2122,1950,1664,3735,3209,4703,3721,4683,5575,3021,3500,232,3017,5564,2684,4048,4285,3146,4706,2770,3522,2219,841,3049,3121,4384,1140,2031,3946,3355,2819,2295,1680,557,629,2054,281,246,2921,4081,1719,957,5100,2223,3506,4064,5314,5802,3000,2152,1845,1644,4546,3341,4828,3306,2820,4405,5370,110,1345,4659,3734,2934,4632,788,5034,490,5478,1052,742,69,4611,1979,5757,4803,4036,3447,5804,3839,2072,4714,104,985,5348,457,4704,761,4171,911,5152,4205,3445,2572,1599,2570,408,176,3883,480,2073,4141,4684,5178,5606,92,4968,1032,1731,3276,4282,2577,1500,1008,5459,947,3329,5638,3213,3802,384,1789,2228,4092,1651,1197,3842,3686,2795,714,2154,5427,2193,4920,2227,1436,4697,3550,5290,4729,4206,5333,5621,2181,23,5267,1702,4549,5762,2918,5223,3632,66,3690,2957,2972,1721,652,5457,356,3970,1575,747,3114,308,4039,4473,1214,1097,3413,3437,3077,2821,2556,1713,5347,632,4529,3815,4629,5837,5486,3460,1147,4796,2033,651,2272,1173,3149,3485,3483,1103,5255,3562,5691,5552,4070,4090,3419,4347,2711,2919,1019,29,4082,1747,3110,424,4850,2817,4076,1798,2636,4035,4243,2281,1646,4096,1434,1822,1678,2314,3827,664,5080,2303,1064,2727,1763,2114,2802,4278,4256,597,2155,3162,3177,2967,5634,5494,4268,4008,4664,3526,3817,5834,4399,1653,1418,1303,2826,2747,4696,2036,4126,5619,249,5437,4635,2075,4154,2120,168,2628,3943,5673,2145,2561,1150,2366,4932,4675,871,1116,1499,4565,5545,4115,4001,4961,4235,526,3696,5300,3796,2637,3059,2000,2517,2062,940,4680,4991,546,386,33,5322,4510,2574,3942,3493,2861,68,3653,5158,730,1542,156,4530,4396,5019,2243,1777,805,2935,2043,1458,524,1987,2486,4376,948,3793,3786,913,3979,4401,1532,2851,1276,2698,5491,1192,93,1198,3618,345,2167,3722,74,1095,5704,3062,2358,462,453,2635,349,288,1598,4255,4614,837,173,4685,5153,2816,4042,5790,2374,3978,1616,2533,5734,691,1431,783,5331,4371,1451,1001,5782,3324,1782,1296,3252,578,2483,620,1483,580,1502,2949,3774,4945,1172,5105,2151,4786,3297,1218,3133,5401,1988,1581,4108,5511,2658,5335,991,686,3025,579,34,512,5266,2201,4834,5503,4104,1474,3818,1261,360,5329,3472,5318,3806,849,5504,4872,5206,4555,4441,4513,2777,1776,5102,4507,3104,5319,183,1242,2543,4604,3738,5830,3088,1143,4294,5618,1896,4179,2230,994,4922,2482,1874,3541,2953,1155,2165,5581,4440,205,1384,4758,3583,4673,5276,5304,2453,5327,1252,3359,1571,109,188,5599,4398,4566,2604,1356,5350,5191,5242,5127,2754,3396,5707,3589,2,9,4811,3347,5060,1378,1498,1015,1057,617,3488,2512,914,4459,1885,4341,1815,3212,4883,3569,4540,2700,754,935,3450,5705,5774,3029,4136,1420,3971,989,20,1842,1963,5130,3411,2575,5155,5763,2294,5281,1797,5643,3237,5841,3856,2876,2139,5522,1551,633,5787,4397,1325,1998,2080,4587,2018,3576,5745,1139,3577,5694,3666,3140,2722,857,1061,4926,3962,3977,3833,1658,3298,4710,2629,4562,2554,4331,5764,4580,3152,4722,2740,2403,3232,1135,550,575,3604,2890,3364,4165,1591,1258,4981,3033,936,4464,3343,3544,284,975,3973,3233,2697,4133,3525,1884,2952,3982,1613,5785,3048,5839,4388,3648,3444,5446,4391,1810,4247,5723,5724,5317,2739,489,3191,1970,1667,5627,519,4789,3698,171,724,4795,5112,5141,5815,3520,2390,446,383,4327,3521,5489,4170,1733,3220,789,4482,3717,5556,5766,4449,4121,2024,613,695,3462,3429,4930,3079,4892,3107,5216,3117,5299,4352,2541,3487,2063,1684,152,5228,2255,234,2610,2463,1248,4157,4044,1327,4584,358,5294,5094,1569,4593,1648,2994,1318,2745,255,4858,402,3015,823,4058,2841,5483,4312,1355,4194,1387,3499,4271,4093,4362,3532,4034,1363,486,5702,4345,2211,3540,4275,3136,3988,4007,2465,883,2536,3575,5030,3456,3349,350,4520,3222,1134,2505,4458,3934,4169,1531,2960,687,3448,1786,5015,1370,4368,5367,1781,4980,240,1342,4080,4403,4814,5053,5084,2588,2023,4496,5512,4279,3357,3316,2751,4954,517,1476,4067,544,399,3200,3476,1729,5453,1971,1044,4864,4283,4245,1469,4344,1694,5442,3165,1190,3022,5571,4848,2109,2529,3094,5537,1723,934,2982,3616,3895,117,5435,3446,703,5166,5583,5239,5654,1982,5043,4817,3281,4452,2261,2176,4503,3486,735,5458,341,4077,102,2988,1240,756,5192,2084,5769,3631,728,2330,4764,2209,5801,1262,1025,200,4581,631,4972,5582,2701,1835,4732,1376,4184,3205,3600,2894,2728,5578,2581,2371,1182,8,4742,3674,5826,3777,3421,467,3661,2115,5351,5337,3617,5309,2775,3851,766,1225,5321,2387,2313,3983,3553,3992,1910,4455,4745,1643,330,627,5671,2991,418,4527,790,3480,124,2275,43,1836,3236,2158,1060,2425,781,1322,4574,5194,655,2362,545,3769,5602,4481,5813,3422,2814,4725,4899,1479,3034,1670,5514,1174,1913,4188,2037,1473,2882,4709,1126,3709,5142,5625,503,904,2438,459,5355,1869,3241,5099,4030,5441,3154,4168,3800,3651,5761,3866,3256,2631,5715,3914,3260,5360,2001,333,3458,2208,5549,1167,130,4226,3517,4857,312,4017,5214,586,287,3391,2291,1856,2869,1383,912,3138,1244,3875,5183,1130,2601,1968,2590,5058,1210,4339,5224,750,2310,244,2759,690,5111,4783,4149,4913,2276,294,3073,4135,254,859,4202,5051,740,3027,5443,5533,592,3367,4346,1315,1457,2433,259,4011,3633,365,5035,1467,4515,3291,5737,1429,322,3513,2164,3740,772,2773,2331,4216,2469,4328,2058,574,5277,4177,3380,3332,961,419,3891,2086,5714,3814,3307,609,1829,1872,531,2382,1056,380,1582,154,4871,5686,4743,3644,2833,5170,2852,1382,5072,3529,5151,607,4751,3163,338,5406,5515,1036,3496,3937,5773,2398,2407,2473,1272,4210,432,5711,3881,527,2225,672,1762,3352,1804,174,3725,1079,2676,2565,4375,1409,1609,2259,2404,5793,4656,5381,2134,2277,2980,1964,5823,4516,1868,4778,1649,4545,5844,4358,2737,4424,4142,5637,224,212,221,815,3261,1465,4676,3381,5550,5604,5659,955,4061,3846,3248,3581,4610,844,5334,3003,1567,2784,4826,1336,370,4838,5109,1299,4672,5270,5017,1791,5547,5426,4113,1189,2971,5193,3228,5743,3627,2247,5464,2146,1482,1194,4148,4319,2761,5519,532,2899,410,5001,1639,107,4145,3187,1974,243,4512,899,4204,895,3795,4640,5792,4231,5196,1321,3257,2335,5342,2436,187,3249,2160,2617,1975,5215,5529,1430,5507,2246,1170,2853,588,2305,3534,3474,5721,1300,4878,3366,4666,4027,2327,4765,2013,5186,1081,3950,4220,4161,2822,2372,3193,3440,2188,848,2252,3492,4193,897,4669,2017,125,1151,487,78,364,1256,958,723,2567,1406,5054,4829,996,2055,2336,2681,3231,1486,4032,273,1517,2147,5251,222,4888,2674,37,4946,2397,278,4486,177,976,5492,3216,3948,3131,1462,3723,812,4137,3221,2741,3175,5444,2977,1792,3356,2197,2986,166,4626,5119,1361,1021,3578,5502,5768,2340,3657,233,2513,960,346,746,15,2254,3161,4163,4038,1521,605,622,4809,4772,5546,1555,4240,5343,5756,3075,2385,485,3020,1154,4223,705,602,3625,4251,5751,5701,5250,1075,4273,225,3202,2110,4213,3009,45,1530,5340,1010,5254,5116,4343,2156,2278,2217,536,3542,1813,3822,5493,2266,4599,3514,4948,1346,2868,1548,3968,3084,1301,969,3481,1544,1799,673,3434,5567,5291,2328,4102,1641,5414,5371,762,1266,2003,4668,1176,2106,267,5052,4970,4413,4307,3143,1552,2161,3782,930,1068,547,1073,738,2087,4128,4618,2200,4539,2267,918,4992,204,2545,2346,987,4645,2542,2446,61,5409,5131,1099,3465,893,4723,2922,577,5739,4421,4615,4066,1992,4437,4782,1448,785,5418,1895,2325,25,2530,3518,5767,649,3383,4802,4578,1730,5222,5373,2534,1403,211,1757,1254,293,5126,1620,3203,3607,4754,2107,2602,4997,5011,4622,1634,4962,5382,324,3952,2546,1808,4460,5832,1926,1849,1166,1513,5420,4929,3922,2903,4887,646,860,3219,3702,1690,2448,4406,2484,5523,4633,3876,5226,4531,5264,2835,1312,476,4917,2863,4383,521,1043,4022,2186,4563,2689,2760,3135,1443,5628,1768,2880,2349,2663,478,146,3346,4453,5786,1388,1572,743,4340,3679,5245,4651,2526,1371,5063,2457,1715,4936,910,1759,3118,1834,808,2498,1766,2640,472,4086,2762,4797,3921,368,454,1546,5450,3743,1208,4139,1353,2510,2611,2053,3263,4000,5364,5325,1923,833,451,1364,3998,3935,2007,2867,2955,5023,1918,4078,3503,1787,1685,997,4019,4885,3268,3046,1183,4939,3572,2612,3797,2312,5106,57,2216,306,250,1320,1456,3468,5411,5520,3217,3031,5167,697,5137,4308,138,2509,2240,2836,4351,764,1160,971,1308,2828,2365,381,4523,5574,2307,1563,4222,5073,921,1735,5140,2680,292,1929,5677,1424,5770,239,639,5784,3880,122,2113,5115,3390,5590,3325,4466,4095,4735,669,3273,858,5041,5181,5412,4024,3939,2691,2172,1633,5278,713,2750,5154,878,3204,2978,3669,1508,1706,3626,571,2354,2074,2221,5683,5416,1449,2341,2736,1415,1772,5477,4763,2769,565,1916,4055,882,1062,24,479,2945,2907,4845,3933,1428,307,2735,3754,689,63,3568,3926,540,3999,371,775,932,630,4955,4909,4636,5709,2495,280,335,112,2614,2718,2926,4937,2781,1157,3323,1369,3479,5303,4662,4551,2862,2525,300,31,3665,5104,4517,2051,3335,1122,455,139,4554,2887,845,4875,411,2734,3438,2551,2654,184,554,5730,2148,2829,262,165,5565,2192,2370,4708,2338,3878,400,855,3902,4595,1547,5809,5696,1127,3322,2742,162,2987,4572,2450,2068,1439,981,548,1016,5248,3912,4236,3640,2933,5013,831,5555,4613,1828,3668,2082,1219,1153,3655,5676,4392,4004,707,2799,3489,1539,2132,4215,4425,1131,807,48,3348,5652,1142,191,2408,876,1527,1440,5139,1946,5384,886,5738,1709,5726,4120,787,525,2071,3095,5046,1573,3780,4625,862,4174,4187,4544,4827,2557,5357,1821,3197,5246,416,3539,155,1307,568,5577,2460,413,3991,4049,5498,4575,5530,194,1526,2177,2384,4667,5332,3259,2984,59,712,5635,4266,3069,342,4085,569,2280,2874,2125,5469,843,1119,3320,3605,4870,5171,752,5133,4333,433,4661,4839,3406,3158,3976,62,4849,1611,5532,5607,4152,1967,5741,4097,2707,2195,423,5394,1243,2417,4438,1040,3176,3113,2079,3752,3936,2809,5174,2286,2873,1480,405,4846,2485,2964,332,1360,5843,3746,435,558,727,3201,2027,2175,1695,4488,5085,4907,537,4736,5753,2319,2983,5395,4414,2687,4720,2011,4492,4051,4084,1564,5465,206,1268,2428,4043,1645,1674,941,3538,2344,44,951,1098,1593,5121,614,1053,4326,1188,2008,3840,2301,741,809,1894,744,2123,2233,5095,428,4601,5026,167,3082,1541,1412,4541,5600,4103,3832,1168,2979,2315,4634,4963,3196,3927,4208,2149,4360,732,873,1962,4808,1925,5609,1888,2696,3602,101,4761,916,4494,5090,3157,1605,317,4118,4305,452,141,4429,5436,925,4298,5579,216,3081,2402,4025,3586,5265,2947,1111,4986,4605,1841,4330,2405,3309,5205,3810,2621,1362,3965,625,2393,1631,4752,493,3238,5286,1372,5725,2973,2352,1002,5010,5146,4110,1323,4882,3969,4655,3571,1832,581,4519,1282,836,864,1673,4389,1069,2471,1141,5209,2406,2915,2598,4359,5800,5501,2190,1584,2198,39,1576,4387,3109,314,942,3564,4434,4647,4013,658,2666,5018,5658,4131,3706,3995,2182,4956,3100,406,323,1228,824,70,3392,1991,1959,3066,5419,1580,4270,2909,5202,791,715,5014,1594,2547,5275,5208,5632,2849,4547,4315,977,1133,3463,1734,297,3321,2092,1215,4302,5516,5559,3527,898,2660,1743,2359,708,3677,1875,720,4776,339,3951,1012,5056,5623,3636,4511,1879,1091,392,5690,320,2738,4297,2803,50,4767,3871,149,928,5646,5021,891,4322,4903,3230,265,5253,1202,4448,1692,5323,1101,2081,2548,201,1716,3896,1794,626,3404,14,2758,5159,3234,4867,2616,5594,5525,4176,3697,4712,2130,4657,4868,4739,2421,2928,1454,3835,4947,4707,2578,2477,3825,5674,5388,5735,1027,5298,946,407,260,670,374,65,4446,2891,5098,5383,3373,3170,704,2035,5780,3195,269,3198,2783,142,2653,5820,5640,385,3639,3816,2884,4950,4016,5776,4646,3623,870,3590,3620,1859,2163,3989,2804,4701,3190,2924,4989,5262,2174,3551,5480,4821,1298,3611,83,2121,1940,3838,5235,1877,3060,2263,3990,17,11,817,593,2791,2494,4552,3288,5423,4508,4658,642,1221,4040,4046,1621,4938,430,4705,4211,903,5662,1213,3470,2708,4759,3164,529,825,993,150,4840,363,5353,4428,5822,964,5305,2998,5720,4249,1223,3925,1503,5439,3394,4536,5838,1165,1419,3264,1094,2300,4238,3428,4419,1771,4462,4898,4728,5258,717,81,4380,1749,5541,5496,3061,5225,5500,3916,4357,4794,5365,2124,2644,1076,4724,4918,1722,1237,2877,5831,1450,3097,5675,1051,5268,1455,1080,2103,3420,4232,1407,1538,1724,4734,1691,5521,1332,2954,3705,709,4192,3139,5656,35,2916,4983,1085,952,2265,5750,4953,3,2168,5135,3565,3108,923,4379,5311,528,5233,1908,2490,5078,1890,352,2678,1399,2886,640,2962,4692,2302,2395,4533,2627,2535,2694,1339,3535,3172,2324,56,2185,3784,1333,5789,2937,2304,4502,2048,86,5700,5229,237,4994,5217,5387,4807,4856,2789,2422,1120,1156,1592,3606,4487,1070,3811,5326,5359,1100,238,522,128,181,5563,5297,1666,1891,5129,4363,4430,3012,5118,3184,1260,734,3744,4919,4691,763,5624,409,5479,3985,2461,1495,2306,4649,3996,1263,2373,1981,3929,4606,3884,907,357,5176,302,2236,1668,2187,2927,2507,193,3497,5236,661,3214,5794,1365,4753,3353,2857,799,4286,4006,2044,800,3615,1553,3621,2633,5749,4018,114,5622,2780,2237,2282,2596,915,1557,3295,5301,2830,1518,4804,4454,1807,1579,4971,1289,1761,227,3849,3823,38,1028,1543,4151,1422,3482,1764,4439,3867,4879,5765,2095,2599,1435,3918,4653,1375,1809,4612,3779,599,2668,3225,3292,3845,3384,4002,5369,3843,733,2129,1224,2764,5819,4746,3023,5526,3573,1697,3799,1851,393,4514,2459,3703,736,4757,2411,3561,3371,5689,1245,2206,3629,1386,4491,299,966,885,3711,4993,1744,5653,2492,4719,1595,1132,3861,2502,2046,2720,1686,5175,3844,4125,2059,1083,2531,3494,1536,990,2274,5799,3507,1509,5020,5148,541,5431,4553,2584,5642,3630,5003,3654,1820,1024,814,5201,5651,4,2323,4579,1269,4314,3315,1577,3277,3923,5033,1785,3057,636,218,2196,2475,4908,745,5312,5241,4155,3888,3147,3599,1477,2632,570,115,3182,1812,3111,3547,3622,4988,401,1864,828,4958,2322,2251,304,3116,2430,3813,1714,1944,1699,2792,5161,4598,5462,3960,2848,866,99,1397,4853,3857,2634,853,816,2667,5324,4843,1676,5471,2056,4990,1780,51,2019,4689,4478,5456,1283,5285,3416,4532,5759,4943,2908,2070,1857,5076,5718,301,3475,3128,5,1463,3855,1708,5308,2061,1604,5077,3326,2437,4609,447,4227,3947,3964,1802,1954,3155,507,5710,1238,4400,2245,71,5123,4138,1838,2128,3938,4847,944,158,4477,4737,5125,5169,175,2381,5055,4509,5330,3267,2765,2452,2946,1990,4471,1854,729,494,3584,1251,351,279,2350,2248,1811,1490,2669,261,4569,3293,3478,1647,4687,5518,1728,5045,1034,1980,1037,5744,5103,2143,3240,3885,2930,3328,471,108,4304,2316,5341,667,2441,1310,3294,515,1562,1622,3283,470,3473,2975,4906,4716,3954,3643,3628,5249,3405,3168,1316,89,1870,5810,77,1687,2285,1823,5657,133,1026,1249,2089,5203,3156,5648,3192,4813,4832,3649,4284,3593,5377,394,5576,5022,5272,542,677,4381,518,180,2725,4310,2920,2348,3924,67,3166,2431,1175,2396,1951,725,1348,3597,3044,4733,2662,4150,5666,1784,1009,4771,2184,1000,2782,4500,134,3427,1583,1233,3794,2723,458,5703,3402,3331,822,1163,5002,1750,4015,1816,3609,2661,523,4166,327,1018,1533,5405,3574,4173,4280,2625,3913,3944,429,1920,505,4191,2242,3344,1102,506,924,1921,1677,3461,1901,2550,4643,4855,3159,5717,3801,5143,5557,3641,4727,1328,2901,4790,511,4528,192,4996,4404,4474,2389,3917,3122,3137,4665,55,4825,2659,4483,1806,3388,2464,1911,95,1662,2231,2846,2289,1897,1919,4952,2386,5631,3258,1928,4005,2715,856,2099,643,1273,1380,576,1496,778,4098,4309,5685,3663,5212,5243,1878,5572,4967,1860,5356,4143,978,1109,4506,4637,2778,3749,4699,2235,4842,145,2709,4880,247,4119,5339,894,2212,1179,2685,5708,2047,4443,838,2050,2434,5198,4499,2582,1736,1239,3099,3339,682,5064,4837,3785,4329,1886,3115,2600,3340,4744,1669,2360,5678,3005,970,1366,1241,4631,4688,5263,1004,1783,5117,5540,926,3130,1390,3350,4276,3011,5231,4788,3042,161,412,3949,4394,4493,2214,376,1819,685,5775,3080,1773,1347,1528,995,4749,2449,1619,3716,4367,3409,1235,5596,3016,1230,1650,1586,482,585,4124,1516,4602,2204,5150,3414,722,2670,4835,417,4583,1220,1858,4277,1484,4951,2332,291,4964,2910,1231,2468,4207,5179,1924,1758,4321,4244,103,5408,1906,3820,3183,3050,4890,4624,5644,94,2605,1871,1614,3683,5467,2532,2626,2963,4663,2713,1826,937,4465,2594,2268,819,2445,1049,1512,767,3762,606,3776,5452,3040,1171,702,1675,3730,1610,5615,3153,4450,2695,4386,5470,1862,1138,3471,2342,1601,4756,213,3287,4693,258,18,2913,5614,4548,136,3612,2997,172,2454,2732,1995,644,1852,1740,4261,892,3650,1144,2317,3386,4861,1229,1801,2956,2850,3105,2586,559,3714,1319,647,2752,5508,3417,3484,2127,1162,4718,3637,2665,1226,4221,2702,5664,182,674,2942,274,5641,1638,1873,3692,210,2171,5071,2800,5587,1861,220,1280,4652,1738,3737,3181,353,4979,4627,2379,3834,5620,1844,3751,1887,1050,2959,2515,5279,968,5650,3694,2015,4537,4740,32,2500,2889,3932,887,1065,4071,4107,309,3432,440,1394,202,3907,4296,2489,4830,2088,5842,3699,4056,3645,3660,1350,3826,4966,2361,4408,135,5413,2108,2583,3911,2576,1630,2837,1942,688,5134,931,5447,4823,4303,3719,85,3218,4921,3755,2558,4484,5808,5313,5553,4436,3112,615,1207,2005,3071,3798,2021,650,2559,660,2451,3972,3850,282,2279,1185,270,1917,5344,3058,2552,1177,189,4186,4348,2834,1437,5592,3093,5238,2580,1041,1712,3877,4472,2650,5451,2504,2351,257,4854,4603,4069,3296,663,4335,1379,3334,3254,2117,5048,2038,2367,1124,880,4526,589,1840,4435,3101,1108,4780,1311,5271,2976,1915,3610,2772,325,1606,1045,3788,1824,3712,3511,2094,4648,5147,2704,5681,2579,164,3515,329,5531,2622,19,3174,5722,999,1306,1349,5079,4831,3554,4241,5463,2104,3958,120,2965,6,4910,1222,2064,4390,5432,3134,2643,618,4973,4433,5660,1335,5188,5755,2911,3150,252,4167,336,801,5827,179,2710,3375,2520,1078,147,1903,2400,1106,1087,296,185,4730,5374,5306,5296,5433,3299,1195,4134,73,2357,1958,5189,1187,5807,1137,1889,5612,436,1755,2537,5038,4822,549,1112,1800,4182,872,4561,1169,2788,1814,4779,3389,3041,4057,5315,4353,1997,573,3362,4543,5539,5349,3250,75,5798,1769,2706,3715,1945,5039,5706,3758,965,3403,420,2544,4504,2827,2688,5128,4415,4427,5697,2623,5836,5114,2435,4505,959,2731,5068,956,1931,2226,2642,3967,1468,4594,1941,5016,2012,3546,3536,96,5302,1700,3959,2392,684,5422,3693,2888,253,5605,4542,5513,4033,1659,3624,1354,4162,2571,4873,4805,3741,2585,1088,840,1608,3490,1568,4026,2178,1506,1305,2647,2480,4457,5036,4886,2951,3314,2112,1304,1054,3710,1005,2573,5375,5610,1404,4083,5593,1288,680,3280,2798,3872,3658,1274,466,1492,3070,1880,1445,1657,4378,1566,266,5449,4293,5075,2493,1550,5754,3519,2703,347,2456,5307,2508,4349,4258,4638,3385,5429,425,2974,771,3664,1718,5818,721,2238,236,2906,5506,2440,4047,1441,3247,4619,3408,821,671,4289,1058,1717,1452,3975,1515,5474,793,3504,121,131,1770,3144,4014,1281,5788,3045,3215,5740,3282,1965,3305,2220,718,2657,3766,4228,2009,4944,3074,431,1159,3004,5124,868,4558,619,1607,4253,87,3455,4239,1205,5122,5828,2487,5534,4781,3245,2298,4497,229,2615,3771,1922,5695,2683,3701,3847,4570,4982,4564,5393,1389,5391,984,5389,2376,1104,909,1178,2904,5088,4442,502,4059,3319,2527,5598,311,5495,4385,906,3119,5733,3955,3807,1635,3365,2290,5760,5247,118,5009,4900,4806,1401,4501,1912,3145,2105,1999,5004,4313,3700,4859,1093,2825,1411,2620,1867,375,2144,3265,5497,460,1444,1129,2672,3038,4775,5562,2006,2333,396,5731,1818,226,1996,2568,1741,1487,4586,4164,4924,1453,5569,3753,3363,1618,4301,28,2415,2679,1055,716,2730,1642,4300,5570,4616,2458,566,3570,2608,1357,5630,2299,1475,1596,3338,4254,2213,1115,1255,3053,1022,4630,2810,628,4054,2439,4750,5461,5092,5629,963,2364,693,1847,850,1883,1286,1796,3791,3742,2076,328,2258,4819,3596,1216,1969,5392,285,2162,3656,3670,5027,2871,4320,5256,1393,3453,2549,1396,1827,681,3477,3770,1416,3873,1478,3558,2101,144,4538,2779,668,337,2467,4267,1660,4800,4597,3239,3090,516,3271,3361,1519,2855,404,5728,4336,1937,2865,2989,2260,1491,2996,1556,4461,3879,4409,2729,4147,4784,1882,3006,1661,5636,5376,4891,3601,1855,5608,564,4020,4114,2807,1588,929,4190,2383,1033,5746,1184,4877,5425,4195,5475,2065,4021,2609,4117,1470,3945,305,4087,5338,810,5378,1866,2292,1275,5067,3127,2771,2948,3781,1181,442,2743,3318,5136,461,692,2638,1617,1413,5613,160,334,867,3148,1505,4130,3603,3308,5310,5007,1837,331,5195,2057,5260,3091,4726,4225,3300,2914,861,638,5814,2090,5626,3792,4426,4852,5157,2100,562,443,1788,1636,47,4567,2892,4935,4100,1257,391,3729,4912,2491,2619,2968,1059,1206,583,1340,5397,2093,2511,543,3707,2705,1014,5293,2222,2756,2096,4774,2793,1146,3897,2424,3459,5597,228,4617,3528,2020,1338,5200,1525,696,4889,2524,1626,5485,5633,1624,2039,3829,2832,755,3286,5096,739,3030,5454,3789,3278,3369,3559,1683,1082,3377,1023,4364,5499,3524,2284,2288,1287,4949,950,199,2296,196,719,1745,520,27,1293,2249,1790,2757,1425,344,5693,2159,3893,2690,1760,5062,1909,1850,4911,879,3830,4447,953,3211,492,4588,3229,1302,4053,4995,4361,4122,390,2014,2815,3941,623,4374,1123,1585,5168,5588,797,2944,1110,2126,3007,3435,3039,2936,111,1314,584,5227,4196,5164,4715,3750,1914,5399,4031,4198,4698,3064,5031,4467,4337,5568,1472,483,116,4299,5672,1204,5160,4940,3436,4037,5509,4959,2269,2215,5149,4265,5729,3495,5156,3548,927,5097,2854,710,5716,818,3056,3920,4183,208,2067,1291,3908,295,4793,556,5282,4760,4965,3882,5107,2664,1493,5601,499,426,641,5040,1326,501,10,2194,2353,4916,4985,967,1313,4738,877,4977,4592,1007,3905,5840,1720,2140,481,3345,4203,3516,148,2271,1689,5274,4522,4259,683,3533,698,5778,2797,3179,377,3243,4694,675,4690,5289,3502,2569,2786,3764,1277,4172,3930,5669,198,445,1701,473,5185,497,4476,1603,2591,1540,1726,2958,4942,3940,3543,1343,495,2045,2410,1471,5069,5554,1578,1433,4230,7,4681,2652,2716,5781,1013,230,2692,268,3124,1853,1833,3372,1640,2860,4229,2205,5835,1125,5811,3303,591,5783,2356,5586,2847,5803,4639,5057,2283,3336,3919,5220,4218,3579,2170,5006,1193,2078,2496,248,4160,4262,4089,3395,1092,3269,4451,1756,2179,1381,1466,2199,4577,4582,1497,3018,450,5081,4402,151,4116,4263,4820,3787,3812,3662,2218,397,4897,2895,3900,496,2838,2540,706,2004,3173,2794,3987,4091,4895,3614,1234,1725,3732,1196,1344,3199,2345,5044,826,758,1152,2098,4976,3210,3083,275,3423,1417,2893,2401,195,1529,4158,846,4620,2562,5611,1830,387,2083,41,2337,3672,5791,3961,4480,40,2831,3171,5481,2645,3374,4768,3863,1955,1149,4590,5199,5190,945,3545,4556,4432,1514,1006,5029,4325,3327,1267,362,939,5777,3684,4199,1292,4600,4201,2141,3443,2256,1459,2864,5535,1324,922,4596,4695,2173,5732,5218,3008,2639,30,272,4342,1778,5091,1698,5368,3378,595,2969,1948,2169,157,5398,2606,3246,5796,1199,3726,2343,4525,1710,3279,26,2808,463,1892,4818,852,1391,4901,264,2420,1265,2805,2646,4650,4762,3342,1524,209,5120,768,1423,4316,3508,1905,3412,52,2553,3718,1654,1865,4246,235,2925,1831,1737,678,1629,2693,4445,2426,611,4355,3824,4866,1803,3704,3763,5639,1898,5083,3397,5421,4682,2368,5440,5244,137,4960,513,1145,5647,1765,3227,3733,1446,439,3451,4670,3024,4987,3382,5661,1385,4641,1426,1180,2812,3837,2806,4288,1793,1494,510,5363,3253,3858,5037,4741,2774,106,2523,2321,2032,666,449,1148,2699,654,1395,2287,3028,4560,504,2142,4923,4642,5372,4234,1511,2885,4766,5180,5719,1705,2116,2244,3010,1117,4257,2950,5817,5182,3892,2748,3646,5558,1489,1294,12,1447,3425,3870,5417,2677,4791,1077,1358,616,241,98,3078,2785,4927,4366,1402,760,4407,3728,3400,2597,3731,4217,3151,4893,1400,2592,2843,1290,4003,5280,3129,3501,2673,355,5779,3974,5616,4318,343,1559,748,4010,3619,4799,1863,2028,3957,3557,509,796,3659,5484,5797,3418,4317,4925,2297,123,3387,5543,2746,2318,3928,905,2811,378,3103,1939,2767,5187,662,2137,3848,4062,2414,3886,2518,4975,4576,4370,1438,2097,4418,3289,5402,794,884,508,4711,5736,207,3854,5527,3759,5833,4654,2320,13,3552,1817,1537,5455,231,5379,1461,3466,3013,1011,1253,974,4571,4028,4585,2896,251,3188,4382,1020,4495,982,5747,2394,4591,4801,100,634,4041,973,3092,5240,4219,4088,3037,4941,3067,5042,1278,4420,1976,214,448,4356,3376,1442,2939,1432,1161,4679,3043,983,1046,3691,803,5207,3370,3311,1590,3457,4969,5358,2391,4931,76,962,60,1615,5145,1953,1754,4068,3567,2881,3760,1217,3469,2801,612,4009,4111,4292,3452,5287,2273,4416,4281,3208,1947,5752,2180,920,1795,3713,757,4475,3242,3393,5404,1030,4674,2334,3014,3642,2655,5445,3652,276,699,3019,46,1086,3688,694,3809,3695,2378,190,4175,865,5138,2818,5682,4140,4422,1703,5561,5065,2726,1876,4291,4816,4998,4860,491,3889,835,5434,2191,4498,900,1084,1421,80,4144,3125,2630,2257,3563,271,359,3068,5510,3063,3512,5396,1933,4470,1029,263,4109,3724,5699,5074,319,1047,53,3676,4485,58,1295,2153,2077,1066,4045,4721,4671,1612,3032,3708,1986,4153,751,5517,382,798,4702,4369,1072,3899,289,2607,4123,2714,2900,3035,530,832,2879,908,488,4535,2866,3898,2293,2555,4132,1485,1367,3001,5132,4573,4678,1560,600,3207,1259,2813,5805,4105,5548,2166,3783,4469,5665,2878,1523,4660,1707,283,366,637,2189,132,2060,5024,5772,4242,90,5482,2210,3358,4250,3647,2563,2648,4072,3549,437,4628,3401,676,4050,3096,2917,4559,701,552,1732,3773,3667,2443,1932,4957,4810,4334,2133,4550,753,4365,3351,4608,3132,4874,2966,4915,5668,3270,2481,1602,1655,4490,1989,780,943,2311,465,5172,498,804,3767,986,4896,1752,3290,829,3864,5560,774,129,1373,1902,4686,1331,2157,3748,3963,2856,2733,5261,4999,5230,5415,2844,1232,5210,4905,4862,5488,3720,5144,2030,1628,5093,5663,4200,4224,372,1096,4159,3915,998,2329,3337,773,469,5585,3678,4700,2347,5049,256,3302,2587,4865,414,2138,4112,1107,3398,3439,2150,313,2375,3585,1696,1846,5219,1681,1843,2241,1545,4372,1665,3255,5113,3808,2990,770,4417,3757,1039,4717,5336,2444,765,1993,1200,5108,3141,5680,4012,5173,127,1961,3689,2993,2250,5538,4792,3430,1105,3424,119,1623,3587,3906,2929,1943,533,1671,1978,2992,3410,598,3745,3997,657,1067,514,2651,3051,2224,3828,5407,389,594,1317,3089,4928,5354,3859,1212,2135,567,5824,170,3841,1748,1739,3169,4101,2840,388,3765,2824,776,2823,4324,2478,3098,54,3910,1211,3756,2264,4798,5795,1900,5400,3903,2516,2041,1330,1035,286,1246,22,468,223,91,3189,2675,5812,5252,3498,4844,303,802,3123,3054,2776,3510,403,84,4747,4272,4769,3454,5028,2940,582,4824,938,3980,4099,2232,3909,4354,2034,3768,3036,1727,340,361,318,456,3354,3206,5490,4621,3595,197,5544,1984,3360,4295,126,3368,2326,4787,2462,36,2474,3272,5386,1627,4373,4233,711,2613,4075,563,3317,5460,1038,1113,3251,3904,4079,421,3804,1600,4094,3304,539,1334,2519,881,4518,2016,5082,5542,3555,3635,731,2514,5283], 3544]
    ]
    start = time.perf_counter()
    for arr, m in test:
        result = Solution3().findLatestStep(arr, m)
        # print(f'{arr}, {m} => {result}')
        print(f'=> {result}')
    end = time.perf_counter()
    print(f'TimeCost: {end} - {start} = {end - start}')
